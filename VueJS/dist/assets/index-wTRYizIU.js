import{D as _,a as y,b as M,c as A,S as C}from"./SearchBar-5eEUiUXa.js";import{C as V,A as k}from"./AtomSpinner-Sdoxd1dX.js";import{I as E,M as U}from"./Modal-faAevnTz.js";import{I as H}from"./Input-w4Lr5OBu.js";import{a as v,m as I,_ as w,r as a,o as r,g as L,b as l,w as h,d as n,c as i,t as b,e as c,h as F,v as P,i as N,T as B,F as T}from"./index-pE5mnqQf.js";import{S as R}from"./Select-C2huDAPV.js";import"./IconSearch-5qFAVXBc.js";const G={name:"AddDoctorModal",data(){return{name:"",surname:"",email:"",mobile:"",hospital:"",image:"",roleName:"",roles:[{id:1,name:"Admin"},{id:2,name:"Doctor"}],hospitals:[],isSaving:!1,isError:!1,message:"",currentStep:1,isSaveHovered:!1}},components:{InputFile:E,Modal:U,Input:H,Select:R},props:["showAddDoctorModal"],emits:["close-modal","is-saving"],computed:{},watch:{showAddPersonalModal(o){o?this.currentStep=1:this.resetForm()},isSaveHovered(){this.isSaveHovered?this.controlFields():this.isError=!1}},methods:{...v(["createUser","getAllHospitals"]),...I(["setCreateUserCreds"]),handleForm(){this.currentStep==2&&(this.$emit("close-modal"),this.$emit("is-saving",this.isSaving))},resetForm(){this.currentStep=1,this.name="",this.surname="",this.email="",this.mobile="",this.hospital="",this.image="",this.isSaving=!1},controlFields(){(this.name===""||this.surname===""||this.email===""||this.mobile===""||this.roleName==="")&&this.showAddDoctorModal?(this.isError=!0,this.message="Please fill all the fields!"):!this.isMailValid()&&this.showAddDoctorModal?(this.isError=!0,this.message="Please enter a valid email!"):!this.isMobileValid()&&this.showAddDoctorModal?(this.isError=!0,this.message="Please enter a valid mobile number!"):this.isError=!1},isMailValid(){let o=this.email;return!!/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/g.test(o)},isMobileValid(){let o=this.mobile;return!!/^(\+90|0)?5\d{9}$/g.test(o)},async _createUser(){this.setCreateUserCreds({email:this.email,roleName:this.roleName,name:this.name,surname:this.surname,mobile:this.mobile,userImage:this.image,password:"123456789"});let o=await this.createUser();return o.status===200||o.status===201?(this.isError=!1,this.message=o.data.message,this.isSaving=!0,!0):(console.log(o),this.isError=!0,this.message=o.data.message,this.isSaving=!1,!1)},async _getAllHospitals(){try{this.hospitals=await this.getAllHospitals(),console.log(this.hospitals)}catch(o){console.log(o)}},async finish(){let o=!1;o=await this._createUser(),o&&this.currentStep++}},async mounted(){await this._getAllHospitals(),this.resetForm()}},j={key:0,class:"grid lg:grid-cols-2"},q={class:"flex flex-col items-center border-b border-r border-light"},z={class:"flex pt-8 pb-8 border-b w-full border-light"},J={class:"border-b flex flex-col gap-4 border-light p-6"},K={key:0,class:"text-red-500 text-s text-secondary-800 text-center"},O={key:1,class:"flex-1 flex flex-col justify-center items-center gap-4 w-[500px] mx-auto"},Q={class:"text-center text-2xl font-semibold text-primary"},W={class:"flex items-center gap-x-6 p-8 mt-auto border-t border-light"},X=["disabled"],Y={key:3,class:"bg-primary text-black rounded-2xl px-4 py-2",type:"submit"};function Z(o,s,x,S,e,m){const g=a("InputFile"),u=a("Input"),d=a("Select"),f=a("Modal");return r(),L(B,{to:"body"},[l(f,{title:"Add Doctor",showModal:x.showAddDoctorModal,onCloseModal:s[13]||(s[13]=t=>o.$emit("close-modal")),noPadding:"",fixedHeight:"",md:!0},{content:h(()=>[n("form",{class:"flex-1 flex flex-col w-full h-full",onSubmit:s[12]||(s[12]=N((...t)=>m.handleForm&&m.handleForm(...t),["prevent"]))},[e.currentStep==1?(r(),i("div",j,[n("div",q,[n("div",z,[l(g,{type:"image",class:"mx-auto",onNewImage:s[0]||(s[0]=t=>e.image=t)})])]),n("div",J,[l(u,{modelValue:e.name,"onUpdate:modelValue":s[1]||(s[1]=t=>e.name=t),placeholder:"Name",outline:"",error:e.isError&&e.name===""},null,8,["modelValue","error"]),l(u,{modelValue:e.surname,"onUpdate:modelValue":s[2]||(s[2]=t=>e.surname=t),placeholder:"Surname",outline:"",error:e.isError&&e.surname===""},null,8,["modelValue","error"]),l(u,{modelValue:e.email,"onUpdate:modelValue":s[3]||(s[3]=t=>e.email=t),placeholder:"E-Posta",outline:"",error:(e.email===""||!m.isMailValid())&&e.isError},null,8,["modelValue","error"]),l(u,{modelValue:e.mobile,"onUpdate:modelValue":s[4]||(s[4]=t=>e.mobile=t),placeholder:"Mobile",outline:"",error:(e.mobile===""||!m.isMobileValid())&&e.isError},null,8,["modelValue","error"]),l(d,{outline:"",modelValue:e.hospital,"onUpdate:modelValue":s[5]||(s[5]=t=>e.hospital=t),placeholder:"Hospital",options:e.hospitals},null,8,["modelValue","options"]),l(d,{outline:"",modelValue:e.roleName,"onUpdate:modelValue":s[6]||(s[6]=t=>e.roleName=t),placeholder:"Select Role",options:e.roles,error:e.isError&&e.roleName===""},null,8,["modelValue","options","error"]),e.isError?(r(),i("div",K,b(e.message),1)):c("",!0)])])):c("",!0),e.currentStep==2?(r(),i("div",O,[n("div",Q,b(e.message),1)])):c("",!0),n("div",W,[e.currentStep!=1?(r(),i("button",{key:0,class:"bg-primary text-black rounded-2xl px-4 py-2 ml-auto",onClick:s[7]||(s[7]=t=>e.currentStep--)}," Back ")):(r(),i("button",{key:1,class:"bg-primary text-black rounded-2xl px-4 py-2 ml-auto",onClick:s[8]||(s[8]=t=>o.$emit("close-modal"))}," Cancel ")),e.currentStep!=2?F((r(),i("button",{key:2,class:"bg-primary text-black rounded-2xl px-4 py-2",onMouseenter:s[9]||(s[9]=t=>e.isSaveHovered=!0),onMouseleave:s[10]||(s[10]=t=>e.isSaveHovered=!1),disabled:e.isError,onClick:s[11]||(s[11]=(...t)=>m.finish&&m.finish(...t))}," Add Doctor ",40,X)),[[P,e.currentStep==1||e.currentStep==2]]):c("",!0),e.currentStep==2?(r(),i("button",Y," Done ")):c("",!0)])],32)]),_:1},8,["showModal"])])}const $=w(G,[["render",Z],["__scopeId","data-v-96cdce84"]]),ee={name:"doctor",components:{DxDataGrid:_,DxColumn:y,DxPaging:M,DxPager:A,ContentPanel:V,SearchBar:C,AddDoctorModal:$,AtomSpinner:k},props:{},data(){return{searchTerm:"",showAddDoctorModal:!1,doctors:[{id:1,name:"Ali",surname:"Veli",email:"aliveli@mail.com",mobile:"05555555555",hospital:"Hospital 1"},{id:2,name:"David",surname:"Beckham",email:"davidbeckham@mail.com",mobile:"05555555555",hospital:"Hospital 2"},{id:3,name:"Cristiano",surname:"Ronaldo",email:"cristianoronaldo@mail.com",mobile:"05555555555",hospital:"Hospital 3"},{id:4,name:"Lionel",surname:"Messi",email:"leomessi@mail.com",mobile:"05555555555",hospital:"Hospital 4"}],isSaving:!1,filteredDoctors:[],isLoading:!0}},computed:{filteredItems(){return this.doctors.filter(o=>o.name.toLowerCase().includes(this.searchTerm.toLowerCase())||o.surname.toLowerCase().includes(this.searchTerm.toLowerCase())||o.email.toLowerCase().includes(this.searchTerm.toLowerCase())||o.mobile.toLowerCase().includes(this.searchTerm.toLowerCase()))}},watch:{async isSaving(o){this.isSaving&&await this._getAllUsers()}},methods:{...v(["getAllUsers"]),async _getAllUsers(){this.isLoading=!0;try{this.doctors=await this.getAllUsers(),this.isLoading=!1}catch(o){console.log(o)}}},async mounted(){await this._getAllUsers()}},se={class:"w-[1090px] flex flex-row items-center justify-between"},oe={class:"w-[150px]"},te={key:0,class:"flex justify-center items-center h-[500px]"},le={key:1,class:"table-responsive"};function re(o,s,x,S,e,m){const g=a("SearchBar"),u=a("AtomSpinner"),d=a("DxColumn"),f=a("DxDataGrid"),t=a("ContentPanel"),D=a("AddDoctorModal");return r(),i(T,null,[l(t,null,{header:h(()=>[n("div",se,[l(g,{items:e.doctors,placeholder:"Search Doctor","onUpdate:searchTerm":s[0]||(s[0]=p=>e.searchTerm=p),class:"w-full"},null,8,["items"]),n("div",oe,[n("button",{class:"bg-primary text-black rounded-2xl px-4 py-2",onClick:s[1]||(s[1]=p=>e.showAddDoctorModal=!0)}," + Add Doctor ")])])]),content:h(()=>[e.isLoading?(r(),i("div",te,[l(u,{color:"#BEEBE5","animation-duration":1e3})])):c("",!0),e.isLoading?c("",!0):(r(),i("div",le,[l(f,{"data-source":m.filteredItems,class:"clickable-row",selection:{mode:"single"}},{default:h(()=>[l(d,{"data-field":"name",alignment:"center"}),l(d,{"data-field":"surname",alignment:"center"}),l(d,{"data-field":"email",alignment:"center"}),l(d,{"data-field":"mobile",alignment:"center"})]),_:1},8,["data-source"])]))]),_:1}),l(D,{showAddDoctorModal:e.showAddDoctorModal,onCloseModal:s[2]||(s[2]=p=>e.showAddDoctorModal=!1),onIsSaving:s[3]||(s[3]=p=>e.isSaving=p)},null,8,["showAddDoctorModal"])],64)}const pe=w(ee,[["render",re]]);export{pe as default};
