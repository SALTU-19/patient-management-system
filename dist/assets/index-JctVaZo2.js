import{D as M,a as V,b as y,c as C,S as A}from"./SearchBar-5eEUiUXa.js";import{C as _,A as k}from"./AtomSpinner-Sdoxd1dX.js";import{I as D,M as E}from"./Modal-faAevnTz.js";import{I}from"./Input-w4Lr5OBu.js";import{a as b,m as F,_ as v,r as d,o as l,g as L,b as o,w as c,d as m,c as n,t as x,e as u,h as B,v as U,i as z,T,F as H}from"./index-pE5mnqQf.js";import"./IconSearch-5qFAVXBc.js";const N={name:"AddPatientModal",data(){return{selectedDate:null,selectFarm:null,selectJob:null,options:[{id:1,name:"Option 1"},{id:2,name:"Option 2"},{id:3,name:"Option 3"}],name:"",surname:"",email:"",phone:"",address:"",image:"",age:"",size:"",weight:"",bmi:"",isSaving:!1,isError:!1,message:"",currentStep:1,isSaveHovered:!1}},components:{InputFile:D,Modal:E,Input:I},props:["showAddPatientModal"],emits:["close-modal"],computed:{},watch:{showAddPatientModal(i){i?this.currentStep=1:this.resetForm()},isSaveHovered(){this.isSaveHovered?this.controlFields():this.isError=!1}},methods:{...b(["createPatient"]),...F(["setCreatePatientCreds"]),handleForm(){this.currentStep==2&&(this.$emit("close-modal"),this.$emit("is-saving",this.isSaving))},resetForm(){this.name="",this.surname="",this.email="",this.phone="",this.address="",this.image="",this.age="",this.size="",this.weight="",this.bmi="",this.isSaving=!1,this.isError=!1,this.message="",this.currentStep=1,this.isSaveHovered=!1},controlFields(){(this.name===""||this.surname===""||this.email===""||this.phone===""||this.address===""||this.age===""||this.size===""||this.weight===""||this.bmi==="")&&this.showAddPatientModal?(this.isError=!0,this.message="Please fill all fields"):!this.isMailValid()&&this.showAddPatientModal?(this.isError=!0,this.message="Please enter a valid email!"):!this.isMobileValid()&&this.showAddPatientModal?(this.isError=!0,this.message="Please enter a valid phone number!"):this.isError=!1},isMobileValid(){let i=this.phone;return!!/^(\+90|0)?5\d{9}$/g.test(i)},isMailValid(){let i=this.email;return!!/\S+@\S+\.\S+/.test(i)},async _createPatient(){this.isSaving=!0,this.setCreatePatientCreds({name:this.name,surname:this.surname,phone:this.phone,mail:this.email,address:this.address,age:this.age,size:this.size,weight:this.weight,bodyMassIndex:this.bmi,bmi:this.bmi,image:this.image});let i=await this.createPatient();return console.log(i),i.status===200||i.status===201?(this.isError=!1,this.message=i.data.message,this.isSaving=!0,!0):(console.log(i),this.isError=!0,this.message=i.data.message,this.isSaving=!1,!1)},async finish(){let i=!1;i=await this._createPatient(),i&&this.currentStep++}},async mounted(){this.resetForm()}},R={key:0,class:"grid lg:grid-cols-2"},G={class:"flex flex-col items-center border-b border-r border-light"},j={class:"flex pt-8 pb-8 border-b w-full border-light"},O={class:"border-b flex flex-col gap-4 border-light p-6"},J={key:0,class:"text-red-500 text-s text-secondary-800 text-center"},W={key:1,class:"flex-1 flex flex-col justify-center items-center gap-4 w-[500px] mx-auto"},q={class:"text-center text-2xl font-semibold text-primary"},K={class:"flex items-center gap-x-6 p-8 mt-auto border-t border-light"},Q=["disabled"],X={key:3,class:"bg-primary text-black rounded-2xl px-4 py-2",type:"submit"};function Y(i,t,f,w,e,a){const g=d("InputFile"),r=d("Input"),h=d("Modal");return l(),L(T,{to:"body"},[o(h,{title:"Add Patient",showModal:f.showAddPatientModal,onCloseModal:t[16]||(t[16]=s=>i.$emit("close-modal")),noPadding:"",fixedHeight:"",md:!0},{content:c(()=>[m("form",{class:"flex-1 flex flex-col w-full h-full",onSubmit:t[15]||(t[15]=z((...s)=>a.handleForm&&a.handleForm(...s),["prevent"]))},[e.currentStep==1?(l(),n("div",R,[m("div",G,[m("div",j,[o(g,{type:"image",class:"mx-auto",onNewImage:t[0]||(t[0]=s=>e.image=s)})])]),m("div",O,[o(r,{modelValue:e.name,"onUpdate:modelValue":t[1]||(t[1]=s=>e.name=s),placeholder:"Name",outline:"",error:e.isError&&e.name===""},null,8,["modelValue","error"]),o(r,{modelValue:e.surname,"onUpdate:modelValue":t[2]||(t[2]=s=>e.surname=s),placeholder:"Surname",outline:"",error:e.isError&&e.surname===""},null,8,["modelValue","error"]),o(r,{placeholder:"E-Mail",outline:"",modelValue:e.email,"onUpdate:modelValue":t[3]||(t[3]=s=>e.email=s),error:(e.email===""||!a.isMailValid())&&e.isError},null,8,["modelValue","error"]),o(r,{placeholder:"Mobile",outline:"",modelValue:e.phone,"onUpdate:modelValue":t[4]||(t[4]=s=>e.phone=s),error:(e.phone===""||!a.isMobileValid())&&e.isError},null,8,["modelValue","error"]),o(r,{modelValue:e.address,"onUpdate:modelValue":t[5]||(t[5]=s=>e.address=s),placeholder:"Address",outline:"",error:e.isError&&e.address===""},null,8,["modelValue","error"]),o(r,{modelValue:e.age,"onUpdate:modelValue":t[6]||(t[6]=s=>e.age=s),placeholder:"Age",outline:"",error:e.isError&&e.age===""},null,8,["modelValue","error"]),o(r,{modelValue:e.size,"onUpdate:modelValue":t[7]||(t[7]=s=>e.size=s),placeholder:"Size",outline:"",error:e.isError&&e.size===""},null,8,["modelValue","error"]),o(r,{modelValue:e.weight,"onUpdate:modelValue":t[8]||(t[8]=s=>e.weight=s),placeholder:"Weight",outline:"",error:e.isError&&e.weight===""},null,8,["modelValue","error"]),o(r,{modelValue:e.bmi,"onUpdate:modelValue":t[9]||(t[9]=s=>e.bmi=s),placeholder:"BMI",outline:"",error:e.isError&&e.bmi===""},null,8,["modelValue","error"]),e.isError?(l(),n("div",J,x(e.message),1)):u("",!0)])])):u("",!0),e.currentStep==2?(l(),n("div",W,[m("div",q,x(e.message),1)])):u("",!0),m("div",K,[e.currentStep!=1?(l(),n("button",{key:0,class:"bg-primary text-black rounded-2xl px-4 py-2 ml-auto",onClick:t[10]||(t[10]=s=>e.currentStep--)}," Back ")):(l(),n("button",{key:1,class:"bg-primary text-black rounded-2xl px-4 py-2 ml-auto",onClick:t[11]||(t[11]=s=>i.$emit("close-modal"))}," Cancel ")),e.currentStep!=2?B((l(),n("button",{key:2,class:"bg-primary text-black rounded-2xl px-4 py-2",onMouseenter:t[12]||(t[12]=s=>e.isSaveHovered=!0),onMouseleave:t[13]||(t[13]=s=>e.isSaveHovered=!1),disabled:e.isError,onClick:t[14]||(t[14]=(...s)=>a.finish&&a.finish(...s))}," Add Patient ",40,Q)),[[U,e.currentStep==1||e.currentStep==2]]):u("",!0),e.currentStep==2?(l(),n("button",X," Done ")):u("",!0)])],32)]),_:1},8,["showModal"])])}const Z=v(N,[["render",Y],["__scopeId","data-v-b64639cb"]]),$={name:"patient",components:{DxDataGrid:M,DxColumn:V,DxPaging:y,DxPager:C,ContentPanel:_,SearchBar:A,AddPatientModal:Z,AtomSpinner:k},props:{},data(){return{searchTerm:"",showAddPatientModal:!1,patients:[{id:1,name:"Ali",surname:"Veli",mail:"aliveli@mail.com",phone:"05555555555"},{id:2,name:"David",surname:"Beckham",mail:"davidbeckham@mail.com",phone:"05555555555"},{id:3,name:"Cristiano",surname:"Ronaldo",mail:"cristianoronaldo@mail.com",phone:"05555555555"},{id:4,name:"Lionel",surname:"Messi",mail:"leomessi@mail.com",phone:"05555555555"}],filteredPatients:[],isSaving:!1,isLoading:!0}},computed:{filteredItems(){return this.patients.filter(i=>i.name.toLowerCase().includes(this.searchTerm.toLowerCase())||i.surname.toLowerCase().includes(this.searchTerm.toLowerCase())||i.mail.toLowerCase().includes(this.searchTerm.toLowerCase())||i.phone.toLowerCase().includes(this.searchTerm.toLowerCase()))}},methods:{goPatientDetail({selectedRowsData:i}){const t=i[0];this.$router.push(`patients/${t.uId}`)},...b(["getAllPatients"]),async _getAllPatients(){this.isLoading=!0;try{this.patients=await this.getAllPatients(),this.isLoading=!1}catch(i){console.log(i)}}},watch:{async isSaving(i){this.isSaving&&await this._getAllPatients()}},async mounted(){await this._getAllPatients()}},ee={class:"w-[1090px] flex flex-row items-center justify-between"},te={class:"w-[150px]"},se={key:0,class:"flex justify-center items-center h-[500px]"},ie={key:1,class:"table-responsive"};function oe(i,t,f,w,e,a){const g=d("SearchBar"),r=d("AtomSpinner"),h=d("DxColumn"),s=d("DxDataGrid"),S=d("ContentPanel"),P=d("AddPatientModal");return l(),n(H,null,[o(S,null,{header:c(()=>[m("div",ee,[o(g,{items:e.patients,placeholder:"Search Patient","onUpdate:searchTerm":t[0]||(t[0]=p=>e.searchTerm=p),class:"w-full"},null,8,["items"]),m("div",te,[m("button",{class:"bg-primary text-black rounded-2xl px-4 py-2",onClick:t[1]||(t[1]=p=>e.showAddPatientModal=!0)},"+ Add Patient")])])]),content:c(()=>[e.isLoading?(l(),n("div",se,[o(r,{color:"#BEEBE5","animation-duration":1e3})])):u("",!0),e.isLoading?u("",!0):(l(),n("div",ie,[o(s,{"data-source":a.filteredItems,class:"clickable-row",selection:{mode:"single"},onSelectionChanged:a.goPatientDetail},{default:c(()=>[o(h,{"data-field":"name",alignment:"center"}),o(h,{"data-field":"surname",alignment:"center"}),o(h,{"data-field":"mail",alignment:"center"}),o(h,{"data-field":"phone",alignment:"center"})]),_:1},8,["data-source","onSelectionChanged"])]))]),_:1}),o(P,{showAddPatientModal:e.showAddPatientModal,onCloseModal:t[2]||(t[2]=p=>e.showAddPatientModal=!1),onSave:t[3]||(t[3]=p=>e.isSaving=p)},null,8,["showAddPatientModal"])],64)}const ue=v($,[["render",oe]]);export{ue as default};
